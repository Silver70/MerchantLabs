type Address {
  id: UUID!
  customerId: UUID!
  type: AddressType!
  line1: String!
  line2: String
  city: String!
  state: String!
  postalCode: String!
  country: String!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type Customer {
  id: UUID!
  firstName: String!
  lastName: String!
  email: String!
  phone: String
  addresses: [Address!]!
  createdAt: DateTime!
  updatedAt: DateTime!
}

type CustomerConnection {
  edges: [CustomerEdge!]!
  pageInfo: PageInfo!
}

type CustomerEdge {
  cursor: String!
  node: Customer!
}

type AddressConnection {
  edges: [AddressEdge!]!
  pageInfo: PageInfo!
}

type AddressEdge {
  cursor: String!
  node: Address!
}

input CreateCustomerInput {
  firstName: String!
  lastName: String!
  email: String!
  phone: String
}

input UpdateCustomerInput {
  firstName: String
  lastName: String
  phone: String
}

input CreateAddressInput {
  customerId: UUID!
  type: AddressType!
  line1: String!
  line2: String
  city: String!
  state: String!
  postalCode: String!
  country: String!
}

input UpdateAddressInput {
  type: AddressType
  line1: String
  line2: String
  city: String
  state: String
  postalCode: String
  country: String
}

input CustomerFilterInput {
  search: String
  email: String
  firstName: String
  lastName: String
  createdAfter: DateTime
  createdBefore: DateTime
}

type CustomerResponse {
  success: Boolean!
  data: Customer
  error: ErrorResponse
}

type AddressResponse {
  success: Boolean!
  data: Address
  error: ErrorResponse
}

type DeleteResponse {
  success: Boolean!
  error: ErrorResponse
}

extend type Query {
  customer(id: UUID!): Customer
  customers(
    first: Int
    after: String
    filter: CustomerFilterInput
  ): CustomerConnection!

  searchCustomers(query: String!, first: Int, after: String): CustomerConnection!

  address(id: UUID!): Address
  addresses(
    customerId: UUID
    type: AddressType
    first: Int
    after: String
  ): AddressConnection!
}

extend type Mutation {
  createCustomer(input: CreateCustomerInput!): CustomerResponse!
  updateCustomer(id: UUID!, input: UpdateCustomerInput!): CustomerResponse!
  deleteCustomer(id: UUID!): DeleteResponse!

  createAddress(input: CreateAddressInput!): AddressResponse!
  updateAddress(id: UUID!, input: UpdateAddressInput!): AddressResponse!
  deleteAddress(id: UUID!): DeleteResponse!
}
